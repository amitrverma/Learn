setwd("C:/SourceCode/Learn/Analytics/R/Unit 2/Assignments/DETECTING FLU")
FluTrain <- read.csv("FluTrain.csv")
summary(FluTrain)
str(FluTrain)
View(FluTrain)
tapply(FluTrain, FluTrain$Queries = 1)
table(FluTrain$Week, FluTrain$Queries ==1 )
tapply(FluTrain, FluTrain$Queries == 1)
table(FluTrain$Week, FluTrain$Queries)
hist(FluTrain$ILI)
log(FluTrain$ILI, FluTrain$Queries)
plot(log(FluTrain$ILI), FluTrain$Queries)
FluTrend1 = lm(log(ILI) ~ Queries, data = FluTrain)
summary(FluTrend1)
cor(FluTrain$ILI, FluTrain$Queries)
cor(FluTrain$ILI, FluTrain$Queries)^2
log(1/cor(FluTrain$ILI, FluTrain$Queries))
Correlation = cor(FluTrain$Queries, log(FluTrain$ILI))
Correlation
FluTest <- read.csv("FluTest.csv")
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
?which
setwd("C:/SourceCode/Learn/Analytics/R/Unit 2/Assignments/FORECASTING ELANTRA SALES")
Elantra <- read.csv("elantra.csv")
summary(Elantra)
str(Elantra)
ElantraTrainin <- subset(Elantra, Elantra$Year < 2013)
ElantraTrain <- subset(Elantra, Elantra$Year < 2013)
View(ElantraTrainin)
View(ElantraTrainin)
remove(ElantraTrainin)
ElantraTest <- subset(Elantra, Elantra$Year > 2012)
View(ElantraTrain)
ESalesReg <- lm(ElantraSales ~ Unemployment+CPI_energy+CPI_all+Queries, data = ElantraTrain)
summary(ESalesReg)
ESalesSeasonReg <- lm(ElantraSales ~ Month+Unemployment+CPI_energy+CPI_all+Queries, data = ElantraTrain)
summary(ESalesSeasonReg)
ESalesSeasonReg2 <- lm(ElantraSales ~ as.factor(Month)+Unemployment+CPI_energy+CPI_all+Queries, data = ElantraTrain)
summary(ESalesSeasonReg2)
cor(ElantraTrain)
ESalesSeasonReg3 <- lm(ElantraSales ~ as.factor(Month)+Unemployment+CPI_energy+CPI_all, data = ElantraTrain)
summary(ESalesSeasonReg3)
ESalesPredict <- predict(ESalesSeasonReg3, newdata = ElantraTest)
SSE = sum((ESalesPredict - ElantraTest$ElantraSales)^2)
SSE
SST = sum((ElantraTest$ElantraSales - mean(ElantraTrain$ElantraSales)^2)
SST = sum(ElantraTest$ElantraSales - mean(ElantraTrain$ElantraSales)^2)
SST = sum(ElantraTest$ElantraSales - mean(ElantraTrain$ElantraSales)^2)
SST = sum((ElantraTest$ElantraSales - mean(ElantraTrain$ElantraSales))^2)
1 - SSE/SST
mean(ESalesPredict)
mean(predict(ESalesSeasonReg3, data = ElantraTrain))
ESalesPredict
ElantraTest$ElantraSales
ElantraTest$ElantraSales - ESalesPredict
ElantraTest
setwd("C:/SourceCode/Learn/Analytics/R/Unit 2/Assignments/STATE DATA")
