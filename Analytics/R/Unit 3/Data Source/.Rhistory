ls()
name <- "amit"
name
ls()
setwd("C:/SourceCode/Learn/Analytics/R/Unit 3/Data Source")
quality = read.csv("auality.csv")
quality = read.csv("quality.csv")
str(quality)
tapply(quality$PoorCare)
table(quality$PoorCare)
install.packages("caTools")
library("caTools")
set.seed(89)
split = sample.split(quality$PoorCare, SplitRatio = 0.75)
split
qualityTrain = subset(quality, split = TRUE)
qualityTest = subset(quality, split = FALSE)
qualityTest = subset(quality, split == FALSE)
qualityTrain = subset(quality, split == TRUE)
QualityLog = glm(PoorCare ~ OfficeVisits + Narcotics , data = qualityTrain, family = binomial)
summary(qualityTrain)
str(QualityLog)
summary(QualityLog)
set.seed(88)
qualityTrain = subset(quality, split == TRUE)
qualityTest = subset(quality, split == FALSE)
QualityLog = glm(PoorCare ~ OfficeVisits + Narcotics , data = qualityTrain, family = binomial)
summary(QualityLog)
predictTrain = predict(QualityLog, type="response")
summary(predictTrain)
tapply(predictTrain, qualityTrain$PoorCare)
tapply(predictTrain, qualityTrain$PoorCare, mean)
table(qualityTrain$PoorCare, predictTrain > 0.5)
10/25
70/74
table(qualityTrain$PoorCare, predictTrain > 0.7)
8/25
73/74
table(qualityTrain$PoorCare, predictTrain > 0.2)
17/25
52/74
install.packages("ROCR")
library(ROCR)
ROCRPred = prediction(predictTrain, qualityTrain$PoorCare)
ROCRPref = performance(ROCRPred, "tpr", "fpr")
plot(ROCRPref)
plot(ROCRPref, colorize = TRUE)
plot(ROCRPref, colorize = TRUE, print.cutoffs.at = seq(0,1,0.1), text.adj = c(-0.2,1.7))
predictTest = predict(QualityLog, type="response", newdata = qualityTest)
ROCPredTest = prediction(predictTest, qualityTest$PoorCare)
auc = as.numeric(performance(ROCPredTest, "auc")@y.values)
auc
framingham = read.csv("framingham.csv")
str(framingham)
library(caTools)
set.seed(1000)
split = sample.split(framingham$TenYearCHD , SplitRatio = 0.65)
train = subset(framingham, split == TRUE)
test = subset(framingham, split == FALSE)
freminghamLog = glm(TenYearCHD ~ ., data = train, family = binomial)
summary(freminghamLog)
predictTest = predict(freminghamLog, type="response", newdata = test)
table(test$TenYearCHD, predictTest > 0.5)
library(ROCR)
ROCRPred = prediction(predictTest, test$TenYearCHD)
as.numeric(performance(ROCRPred, "auc")@y.values)
polling = read.csv("PollingData.csv")
str(polling)
table(polling$Year)
summary(polling)
install.packages("mice")
library(mice)
simple <- polling[c("Rasmussen" , "SurveyUSA", "PropR", "DiffCount")]
summary(simple)
set.seed(144)
imputed <- complete(mice(simple))
summary(simple)
summary(imputed)
polling$Rasmussen <- imputed$Rasmussen
polling$SurveyUSA <- imputed$SurveyUSA
polling$PropR <- imputed$PropR
polling$DiffCount <- imputed$DiffCount
summary(polling)
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
table(Train$Republican)
table(sign(Train$Rasmussen))
table(Train$Republican, sign(Train$Rasmussen))
cor(Train[c("Rasmussen", "SurveyUSA", "DiffCount", "PropR", "Republican")])
mod1 = glm(Republican ~ PropR, data = Train, family = "binomial")
summary(mod1)
pred1 = predict(mod1, type="response")
table(Train$Republican, pred1>=0.5)
mod2 = glm(Republican ~ SurveyUSA + DiffCount, data = Train, family = "binomial")
pred2 = predict(mod2, type="response")
table(Train$Republican, pred2>=0.5)
summary(mod2)
table(Test$Republican, sign(Test$Rasmussen))
TestPrediction = predict(mod2, newdata = Test  , type = "response")
table(Test$Republican, TestPrediction >= 0.5)
subset(Test, TestPrediction >= 0.5, Republican ==0)
subset(Test, TestPrediction >= 0.5 & Republican ==0)
mod3 = glm(Republican ~ Rasmussen + DiffCount, data = Train, family = "binomial")
