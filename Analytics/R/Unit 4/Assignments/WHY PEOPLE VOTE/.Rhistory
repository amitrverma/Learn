setwd("C:/SourceCode/Learn/Analytics/R/Unit 4/Assignments/WHY PEOPLE VOTE")
gerber <- read.csv("gerber.csv")
summary(gerber$voting)
table(gerber$voting)
108696/nrow(gerber)
table(gerber$voting, gerber$self)
table(gerber$self)
table(gerber$self==1)
gerber[gerber$self==1]
gerber(gerber$self==1)
table(gerber$civicduty)
38218/nrow(gerber$civicduty)
table(gerber$civicduty)
38218/(38218+305866)
table(gerber$hawthorne)
38204/(38204+305880)
summary(gerber$civicduty)
str(gerber$civicduty)
table(gerber$civicduty, gerber$voting)
12021/(12021+26197)
table(gerber$self,gerber$voting)
13191/(13191+25027)
table(gerber$neighbors,gerber$voting)
14438/(14438+23763)
table(gerber$hawthorne,gerber$voting)
12316/(12316+25888)
logReg = glm(voting ~ civicduty + hawthorne + self + neighbors, data = gerber, method = binomial)
logReg = glm(voting ~ civicduty + hawthorne + self + neighbors, data = gerber, family = binomial)
summary(logReg)
predLog = predict(logReg)
table(gerber$voting, predLog > 0.3)
108696/(108696+235388)
predLog = predict(logReg, type = "response")
table(gerber$voting, predLog > 0.3)
(134513+51966)/(134513+100875+56730+51966)
table(gerber$voting, predLog > 0.5)
predLog = predict(logReg, type = "response")
table(gerber$voting, predLog > 0.5)
table(gerber$voting, predLog > 0.3)
108696/(108696+235388)
predLog = predict(logReg, type = "response")
table(gerber$voting, predLog > 0.5)
table(gerber$voting, predLog > 0.3)
table(gerber$voting, predLog > 0.4)
table(gerber$voting, predLog > 0.2)
table(gerber$voting, predLog > 0.3)
logReg = glm(voting ~ civicduty + hawthorne + self + neighbors, data = gerber, family = "binomial")
predict = predict(logReg, type = "response")
table(gerber$votingm predict > 0.5)
table(gerber$voting, predict > 0.5)
table(gerber$voting)
cartModel = rpart(voting ~ civicduty + hawthorne + self + neighbors, data=gerber)
library(rpart)
library(rpart.plot)
cartModel = rpart(voting ~ civicduty + hawthorne + self + neighbors, data=gerber)
plot(cartModel)
plot.rpart(cartModel)
cartModel1 = rpart(voting ~ civicduty + hawthorne + self + neighbors, data=gerber, cp=0.0)
plot(cartModel1)
CARTmodel2 = rpart(voting ~ civicduty + hawthorne + self + neighbors, data=gerber, cp=0.0)
plot(CARTmodel2)
library(caTools)
plot(CARTmodel2)
library(caret)
plot(CARTmodel2)
View(gerber)
library(rpart)
library(rpart.plot)
library(caret)
prp(CARTmodel2)
0.3/0.61
CARTmodel3 = rpart(voting ~ civicduty + hawthorne + self + neighbors + sex, data=gerber, cp=0.0)
prp(CARTmodel3)
View(gerber)
CARTmodel4 = rpart(voting ~ control, data=gerber, cp=0.0)
CARTmodel5 = rpart(voting ~ control + sex, data=gerber, cp=0.0)
prp(CARTmodel4, digits = 6)
prp(CARTmodel5, digits = 6)
logReg1 = glm(voting ~ sex + conrol, data = gerber, family = binomial)
logReg1 = glm(voting ~ sex + control, data = gerber, family = binomial)
summary(logReg1)
Possibilities = data.frame(sex=c(0,0,1,1), control = c(0,1,0,1))
Possibilities
predict(logReg1, newdata = Possibilities, type="response")
prp(CARTmodel5, digits = 7)
library(rpart)
library(rpart.plot)
library(caret)
prp(CARTmodel5, digits = 7)
0.2904558-0.2908065
logReg2 = glm(voting ~ sex + control +sex:control, data = gerber, family = binomial)
summary(logReg2)
predict(logReg2, newdata = Possibilities, type="response")
0.2904558-0.2904558
